{% extends '@layout/admin.html.twig' %}

{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('/admin.css') }}">
{% endblock %}

{% block scripts %}
<script>
    const apiURL = "{{ path('api.resources') }}";
    const apiAccessURL = "{{ path('api.access') }}";
</script>
<script src="{{ asset('/resources.js') }}"></script>
{% endblock %}

{% block title %}Resources{% endblock %}

{% block navbar %}
{% include '@includes/admin/navbar/access.html.twig' with {page: 'resources'} only %}
{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center">
    <h1>
        <i class="fas fa-cog"></i>
        Resources
    </h1>
    {% if acl.isAllowed(user.identity, 'admin.access', 'write') %}
    <div>
        <button class="btn btn-primary" id="btn-create">
            <i class="fas fa-plus-circle"></i>
            Add a new resource
        </button>
    </div>
    {% endif %}
</div>

<table class="table table-striped table-sm">
    <thead>
        <tr>
            <th class="text-right">#</th class="text-right">
            <th>Name</th>
            <th>Path</th>
            <th colspan="3">Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for resource in resources %}
        <tr data-id="{{ resource.id }}" data-name="{{ resource.name }}">
            <td class="text-right text-secondary">{{ resource.id }}</td>
            <td>
                <i class="fas fa-cog"></i>
                {{ resource.name }}
            </td>
            <td>
                <a href="{{ resource.path }}" target="_blank" class="text-decoration-none">
                    <i class="fas fa-external-link-alt"></i>
                    <code>{{ resource.path }}</code>
                </a>
            </td>
            <td class="action">
                {% if acl.isAllowed(user.identity, 'admin.access', 'write') %}
                <a role="button" href="#edit" title="Edit">
                    <i class="fas fa-edit"></i>
                    <span class="sr-only">Edit</span>
                </a>
                {% endif %}
            </td>
            <td class="action">
                <!-- <a role="button" href="#lock" title="Lock">
                    <i class="fas fa-lock"></i>
                    <span class="sr-only">Lock</span>
                </a> -->
            </td>
            <td class="action">
                <a role="button" href="#permissions" title="Permissions">
                    <i class="fas fa-key"></i>
                    <span class="sr-only">Permissions</span>
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% if acl.isAllowed(user.identity, 'admin.access', 'write') %}
{% include '@includes/admin/modal/resource.html.twig' %}
{% endif %}
{% include '@includes/admin/modal/permission/role.html.twig' %}

{% endblock %}